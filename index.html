<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FUSIONTICKS | Aperture Light</title>
  <meta name="description" content="FusionTicks: risk-first trading program by Khalid Kuhail. Read the market, stack confirmations, and execute clean setups."/>
  <meta name="theme-color" content="#0A0D14"/>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">

  <!-- Tailwind (utilities only) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans:["Inter","system-ui","-apple-system","Segoe UI","Roboto","Ubuntu","Cantarell"],
            display:["Space Grotesk","Inter","system-ui"]
          }
        }
      }
    }
  </script>

  <!-- Icons -->
  <script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <style>
    /* =================== APERTURE LIGHT - BRAND NEW DNA =================== */
    :root{
      --bg:#F8FAFD;
      --ink:#0A0D14;
      --muted:#5B667A;
      --edge:#E5EDF7;
      --panel:#FFFFFF;
      --strap:#0EA5E9;
      --strap2:#2563EB;
      --accent:#14B8A6;

      --shadow:rgba(2,7,18,.12);
      --shadow-strong:rgba(2,7,18,.18);
      --grid:#0A0D14;
    }

    html{scroll-behavior:smooth}
    body{background:var(--bg); color:var(--ink);}

    .aperture-bg{
      position:absolute; inset:0; z-index:-1; pointer-events:none;
      background:
        radial-gradient(1200px 600px at 85% -10%, rgba(20,184,166,.12), transparent 60%),
        radial-gradient(900px 500px at -10% 20%, rgba(37,99,235,.12), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.75));
      mask:
        linear-gradient(180deg, rgba(0,0,0,.96), rgba(0,0,0,.86) 40%, rgba(0,0,0,.60) 80%, rgba(0,0,0,0));
    }
    .aperture-stripes{
      position:absolute; inset:0; opacity:.06; mix-blend-mode:multiply; pointer-events:none;
      background-image: repeating-linear-gradient(135deg, var(--grid) 0 2px, transparent 2px 12px);
    }
    .aperture-dots{
      position:absolute; inset:0; opacity:.06; pointer-events:none;
      background-image:radial-gradient(var(--grid) 1px, transparent 1px);
      background-size:20px 20px;
      mask: linear-gradient(180deg, #000, transparent 70%);
    }

    .nav{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px) saturate(140%);
      -webkit-backdrop-filter: blur(10px) saturate(140%);
      background: rgba(248,250,253,.75);
      border-bottom:1px solid var(--edge);
    }
    .nav a{ position:relative }
    .nav a:after{
      content:""; position:absolute; left:0; bottom:-8px; height:2px; width:0%;
      background:linear-gradient(90deg, var(--strap), var(--strap2));
      transition:width .2s ease;
    }
    .nav a:hover:after{ width:100% }

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:.6rem;
      height:44px; padding:0 1rem; border-radius:12px; font-weight:700; border:1px solid var(--edge);
      background:#fff; color:var(--ink);
      box-shadow: 0 6px 16px var(--shadow);
    }
    .btn-ghost{ background:transparent; border-color:var(--edge) }
    .btn-primary{
      background:linear-gradient(180deg, var(--strap), var(--strap2));
      color:#fff; border-color:transparent;
      box-shadow: 0 16px 34px rgba(14,165,233,.25), inset 0 1px 0 rgba(255,255,255,.6);
    }

    .hero-grid{ display:grid; grid-template-columns: 1.05fr .95fr; gap:2rem }
    @media (max-width: 1024px){ .hero-grid{ grid-template-columns:1fr } }

    .k-title{
      font-family:var(--font-display, Space Grotesk);
      letter-spacing:-.01em; line-height:1.02;
    }

    .strapline{
      display:inline-flex; align-items:center; gap:.6rem; height:34px; padding:0 .75rem; border-radius:999px; font-size:.82rem;
      background:linear-gradient(180deg, #fff, #F1F6FF); border:1px solid var(--edge);
      box-shadow: 0 10px 24px var(--shadow);
    }
    .strap-badge{
      display:inline-grid; place-items:center; width:22px; height:22px; border-radius:999px; color:#fff;
      background:linear-gradient(180deg, var(--strap2), var(--strap)); font-size:.72rem; font-weight:700;
      box-shadow: 0 8px 18px rgba(37,99,235,.25);
    }

    .poster{
      position:relative; border-radius:18px; background:var(--panel); border:1px solid var(--edge);
      box-shadow: 0 24px 60px var(--shadow-strong);
      overflow:hidden;
    }
    .poster-header{
      display:flex; align-items:center; justify-content:space-between; gap:1rem;
      padding:10px 12px; border-bottom:1px solid var(--edge);
      background:linear-gradient(180deg, #fff, #F7FAFF);
    }
    .spark-wrap{ position:relative; height:380px }
    .spark-wrap canvas{ position:absolute; inset:0; width:100%; height:100% }

    .card{
      background:var(--panel); border:1px solid var(--edge); border-radius:16px; padding:18px;
      box-shadow: 0 14px 28px var(--shadow);
    }

    .eyebrow{
      display:inline-flex; align-items:center; gap:.5rem; height:32px; padding:0 .7rem; border-radius:999px; font-size:.82rem;
      background:#fff; border:1px solid var(--edge); box-shadow:0 6px 16px var(--shadow)
    }
    .beam{ height:2px; background:linear-gradient(90deg, transparent, var(--strap), var(--strap2), transparent); opacity:.9 }

    .rail{ position:relative; padding-left:1.4rem }
    .rail:before{ content:""; position:absolute; left:.6rem; top:.2rem; bottom:.3rem; width:2px; background:linear-gradient(180deg, var(--strap), var(--strap2)); border-radius:2px; }
    .dot{ width:12px; height:12px; border-radius:999px; background:var(--strap); box-shadow:0 0 0 6px rgba(14,165,233,.14); border:1px solid #fff }

    .price{ display:grid; grid-template-columns:1fr auto; align-items:start; gap:1rem; }
    .tag{ display:inline-flex; align-items:center; gap:.45rem; height:28px; padding:0 .6rem; border-radius:999px; font-size:.78rem; background:#F1F6FF; border:1px solid var(--edge) }
    .ring{
      display:inline-grid; place-items:center; width:92px; height:92px; border-radius:999px;
      background: radial-gradient(60% 60% at 50% 50%, rgba(14,165,233,.18), transparent 60%),
                  radial-gradient(100% 100% at 50% 50%, rgba(37,99,235,.18), transparent 70%);
      border:1px solid #EAF2FF; box-shadow:0 16px 34px rgba(14,165,233,.25); font-weight:800;
    }
    .ring span{ background:linear-gradient(180deg, var(--strap2), var(--strap)); -webkit-background-clip:text; background-clip:text; color:transparent }

    .dock{
      position:fixed; left:0; right:0; bottom:16px; z-index:40; display:flex; justify-content:center; pointer-events:none;
    }
    .dock-inner{
      pointer-events:auto; display:flex; align-items:center; gap:.8rem; border:1px solid var(--edge); background:#fff; border-radius:14px; padding:.5rem .6rem;
      box-shadow:0 18px 40px var(--shadow-strong);
    }

    .reveal{opacity:0; transform:translateY(16px); transition:opacity .6s ease, transform .6s ease}
    .reveal.in{opacity:1; transform:none}

    .muted{ color:var(--muted) }
    .no-scrollbar::-webkit-scrollbar{display:none} .no-scrollbar{scrollbar-width:none;-ms-overstyle:none}

    /* =================== ONLY FOR 3 SECTIONS (ACADEMY / JOURNAL / DISCORD) =================== */
    .link-card{
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .link-card:hover{
      transform: translateY(-2px);
      box-shadow: 0 16px 34px var(--shadow-strong);
      border-color: rgba(14,165,233,.35);
    }
    .link-card.is-active{
      border-color: rgba(37,99,235,.35);
      box-shadow: 0 18px 40px rgba(37,99,235,.18);
    }

    .showcase{
      position:relative;
      border-radius:16px;
      border:1px solid var(--edge);
      overflow:hidden;
      background: linear-gradient(180deg, #fff, #F7FAFF);
      box-shadow: 0 18px 44px var(--shadow-strong);
      min-height: 360px;
      --stage-bg: none;
    }

    .showcase::before{
      content:"";
      position:absolute;
      inset:-40px;
      background-image: var(--stage-bg);
      background-size: cover;
      background-position: center;
      filter: blur(22px) saturate(1.25);
      transform: scale(1.08);
      opacity: .22;
      pointer-events:none;
    }

    .showcase::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(800px 260px at 20% 10%, rgba(20,184,166,.10), transparent 60%),
        radial-gradient(900px 340px at 90% 0%, rgba(37,99,235,.10), transparent 60%),
        repeating-linear-gradient(135deg, rgba(10,13,20,.05) 0 2px, transparent 2px 12px);
      opacity:.45;
      pointer-events:none;
      mix-blend-mode:multiply;
    }

    .showcase-top{
      position:relative;
      z-index:2;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px 14px 10px;
    }

    .showcase-top .mini{
      display:flex; align-items:center; gap:8px;
    }
    .showcase-count{
      font-size:12px;
      color: var(--muted);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--edge);
      background:rgba(255,255,255,.85);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .frame{
      position:relative;
      z-index:2;
      margin:0 14px 12px;
      border-radius:14px;
      border:1px solid #EAF2FF;
      overflow:hidden;
      background: #fff;
      box-shadow: 0 20px 52px rgba(2,7,18,.18);
    }

    .frame-bar{
      height:38px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 12px;
      background: linear-gradient(180deg, #fff, #F7FAFF);
      border-bottom:1px solid #EAF2FF;
    }
    .dots3{
      display:flex; gap:7px; align-items:center;
    }
    .dots3 span{
      width:10px; height:10px; border-radius:999px;
      border:1px solid rgba(10,13,20,.10);
      background: rgba(10,13,20,.06);
    }

    .frame-media{
      position:relative;
      aspect-ratio: 16/9;
      width:100%;
      background: #fff;
    }
    .frame-media img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover;
      transform: scale(1.01);
      opacity:0;
      transition: opacity .32s ease, transform .55s ease;
    }
    .frame-media img.is-visible{
      opacity:1;
      transform: scale(1);
    }

    .nav-arrow{
      position:absolute;
      z-index:3;
      top:50%;
      transform: translateY(-50%);
      width:42px; height:42px;
      border-radius:999px;
      border:1px solid var(--edge);
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 12px 28px rgba(2,7,18,.16);
      display:flex; align-items:center; justify-content:center;
      opacity:0;
      transition: opacity .18s ease, transform .18s ease;
    }
    .nav-arrow:hover{ transform: translateY(-50%) scale(1.03); }
    .nav-arrow.left{ left:18px; }
    .nav-arrow.right{ right:18px; }
    .showcase:hover .nav-arrow,
    .showcase:focus-within .nav-arrow{ opacity:1; }

    .thumbs{
      position:relative;
      z-index:2;
      display:flex;
      gap:10px;
      padding:10px 14px 14px;
      overflow:auto;
    }
    .thumb{
      flex:0 0 auto;
      width:86px;
      height:50px;
      border-radius:10px;
      border:1px solid rgba(15,23,42,.10);
      overflow:hidden;
      background:#fff;
      box-shadow: 0 10px 20px rgba(2,7,18,.10);
      opacity:.82;
      cursor:pointer;
      transition: opacity .18s ease, transform .18s ease, border-color .18s ease;
    }
    .thumb:hover{ opacity:1; transform: translateY(-1px); border-color: rgba(14,165,233,.35); }
    .thumb.is-active{ opacity:1; border-color: rgba(37,99,235,.35); box-shadow: 0 16px 30px rgba(37,99,235,.14); }
    .thumb img{ width:100%; height:100%; object-fit: cover; display:block; }

    @media (max-width: 640px){
      .showcase{ min-height: 320px; }
      .nav-arrow{ opacity:1; }
      .thumb{ width:72px; height:44px; }
    }
  </style>
</head>

<body>
  <header class="relative">
    <div class="aperture-bg"></div>
    <div class="aperture-stripes"></div>
    <div class="aperture-dots"></div>

    <!-- Top Nav -->
    <div class="nav">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-[68px] flex items-center justify-between">
        <a href="#" class="flex items-center gap-3">
          <img src="./FT%20Logo.png" alt="FusionTicks" class="h-7 w-auto"/>
          <span class="font-semibold tracking-tight">FUSIONTICKS</span>
        </a>

        <nav class="hidden md:flex items-center gap-6 text-[15px]">
          <a href="#how">How We Trade</a>
          <a href="#academy">FT Academy</a>
          <a href="#journal">FT Journal</a>
          <a href="#discord">Discord</a>
          <a href="#pricing">Prices</a>
          <a href="#faq">FAQ</a>
        </nav>

        <div class="hidden md:flex items-center gap-2">
          <a class="btn-ghost btn" href="#academy"><i data-lucide="book-open" class="w-4 h-4"></i> FT Academy</a>
          <a class="btn btn-primary" href="#pricing"><i data-lucide="arrow-right" class="w-4 h-4"></i> Get Access</a>
        </div>

        <button id="menuBtn" class="md:hidden btn-ghost btn" aria-label="Open menu"><i data-lucide="menu"></i></button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="fixed inset-0 z-50 hidden">
      <div class="absolute inset-0 bg-black/40" data-close></div>
      <div class="absolute right-3 left-3 top-4 rounded-2xl bg-white border border-[var(--edge)]">
        <div class="p-3 flex justify-end">
          <button class="btn-ghost btn" data-close aria-label="Close"><i data-lucide="x"></i></button>
        </div>
        <nav class="px-4 pb-5 grid gap-2 text-base">
          <a class="btn" href="#how">How We Trade</a>
          <a class="btn" href="#academy">FT Academy</a>
          <a class="btn" href="#journal">FT Journal</a>
          <a class="btn" href="#discord">Discord</a>
          <a class="btn" href="#pricing">Prices</a>
          <a class="btn" href="#faq">FAQ</a>
          <a class="btn btn-primary mt-2" href="#pricing">Get Access</a>
        </nav>
      </div>
    </div>

    <!-- HERO CONTENT -->
    <section id="hero" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-12 pb-8 lg:pt-16">
      <div class="hero-grid">
        <div class="relative">
          <span class="strapline">
            <span class="strap-badge">FT</span> Trade Education - No Signals · Risk-First
          </span>

          <h1 class="k-title mt-4 text-5xl sm:text-6xl font-extrabold">
            Trade with <span style="background:linear-gradient(90deg,var(--strap2),var(--strap));-webkit-background-clip:text;background-clip:text;color:transparent">Clarity</span>,<br/>
            Not Noise.
          </h1>

          <p class="mt-5 muted max-w-2xl">
            I started like most traders: YouTube strategies, paid courses, and a lot of frustration.
            Real progress came when I stopped memorizing and began understanding the market. I treat each trade as a setup
            based on the idea that time is fractal: higher timeframe key levels set the bias, lower timeframe levels define
            the entry, and I identify who is in control. Now I teach the same framework inside FusionTicks.
          </p>

          <div class="mt-7 flex flex-wrap gap-3">
            <a href="#pricing" class="btn btn-primary"><i data-lucide="arrow-right" class="w-4 h-4"></i> Get Access</a>
            <a href="#academy" class="btn"><i data-lucide="book-open" class="w-4 h-4"></i> FT Academy</a>
            <span class="tag">NQ · ES · CL · GC · QQQ · SPY</span>
            <span class="tag">Context → Confirm</span>
          </div>

          <div class="mt-8 rounded-xl border border-[var(--edge)] bg-white p-3 flex items-center text-sm">
            <div class="px-3 py-1 rounded-full text-white font-semibold" style="background:linear-gradient(180deg, var(--strap2), var(--strap))">FIRST40</div>
            <div class="ml-3">Launch offer: first 40 get the course for <b>$550</b> (regular <span class="line-through">$1000</span>).</div>
          </div>
        </div>

        <div class="poster">
          <div class="poster-header">
            <div class="flex items-center gap-2">
              <img src="./FT%20Logo.png" alt="FusionTicks" class="h-6 w-auto"/>
              <span class="text-sm text-[var(--muted)]">Signal-free Education</span>
            </div>
            <div class="flex items-center gap-2 text-xs">
              <span class="tag">Risk-First</span>
              <span class="tag">Process &gt; Outcome</span>
            </div>
          </div>

          <div class="spark-wrap">
            <canvas id="spark"></canvas>
            <div class="absolute bottom-3 left-3 right-3 grid grid-cols-3 gap-3 text-center text-[13px]">
              <div class="tag">Context → Confirm</div>
              <div class="tag">Bias from HTF</div>
              <div class="tag">Execution on LTF</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </header>

  <main>
    <!-- HOW IT WORKS -->
    <section id="how" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow">Simple Pipeline</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">How We Trade</h3>
        <p class="mt-2 muted max-w-4xl">
          From preparation to execution, this is a clear process you can repeat daily; strategies alone are a 50/50 gamble, so we flip the odds by reading the market, identifying who’s in control, and stacking confirmations before any entry.
        </p>
      </div>

      <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="card reveal rail">
          <div class="flex items-center gap-3"><span class="dot"></span><div class="font-semibold">1) Prepare</div></div>
          <p class="muted mt-2 ml-8">
            Mark KEY LEVELS on the higher timeframe: S&amp;D and S&amp;R (major buyer/seller zones), then confirm the news.
          </p>

          <div class="mt-6 flex items-center gap-3"><span class="dot"></span><div class="font-semibold">2) Read</div></div>
          <p class="muted mt-2 ml-8">
            As price reaches those levels, watch the reaction and understand whether buyers or sellers are taking control.
          </p>
        </div>

        <div class="card reveal rail">
          <div class="flex items-center gap-3"><span class="dot"></span><div class="font-semibold">3) Confirm</div></div>
          <p class="muted mt-2 ml-8">
            Drop to a lower timeframe, mark the next buyer/seller zones, and collect confirmations for entry (break or hold of the first zone matters).
          </p>

          <div class="mt-6 flex items-center gap-3"><span class="dot"></span><div class="font-semibold">4) Review</div></div>
          <p class="muted mt-2 ml-8">
            Journal every trade so we can review mistakes and continuously improve the process.
          </p>
        </div>
      </div>

      <div class="mt-10 beam"></div>
    </section>

    <!-- FT ACADEMY -->
    <section id="academy" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow"><i data-lucide="book-open" class="w-4 h-4"></i> Course</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">FT Academy</h3>
        <p class="mt-2 muted max-w-3xl">Short lessons. Clear structure. Built for daily use.</p>
      </div>

      <div class="mt-8 grid lg:grid-cols-3 gap-6">
        <!-- LEFT -->
        <div class="lg:col-span-1 space-y-4">
          <article class="card reveal link-card" data-go="academy:0" tabindex="0">
            <div class="flex items-center justify-between">
              <h4 class="font-semibold">A · Reading the Market</h4>
              <span class="tag">6 lessons</span>
            </div>
            <p class="muted mt-2 text-sm">Candlesticks, phases, price in motion, swings, BOS/CHoCH, and FVG.</p>
          </article>

          <article class="card reveal link-card" data-go="academy:1" tabindex="0">
            <div class="flex items-center justify-between">
              <h4 class="font-semibold">B · Market Levels</h4>
              <span class="tag">3 lessons</span>
            </div>
            <p class="muted mt-2 text-sm">Supply &amp; Demand, Support &amp; Resistance, and Opening Range Breakout.</p>
          </article>

          <article class="card reveal link-card" data-go="academy:2" tabindex="0">
            <div class="flex items-center justify-between">
              <h4 class="font-semibold">C · Market Indicators</h4>
              <span class="tag">3 lessons</span>
            </div>
            <p class="muted mt-2 text-sm">Volume Profile, VWAP (Anchored), and EMA inside context.</p>
          </article>

          <article class="card reveal link-card" data-go="academy:3" tabindex="0">
            <div class="flex items-center justify-between">
              <h4 class="font-semibold">D · Behind the Scenes</h4>
              <span class="tag">7 lessons</span>
            </div>
            <p class="muted mt-2 text-sm">TradingView, futures &amp; prop firms, order types, risk, journaling, news, psychology.</p>
          </article>

          <button class="btn btn-primary w-full justify-center reveal" data-curr-open>
            <i data-lucide="list-checks" class="w-4 h-4"></i> View full syllabus
          </button>
        </div>

        <!-- RIGHT (SHOWCASE) -->
        <div class="lg:col-span-2">
          <div class="showcase reveal" data-gallery="academy" aria-label="Academy screenshots slider" tabindex="0">
            <div class="showcase-top">
              <div class="mini">
                <span class="tag"><i data-lucide="book-open" class="w-4 h-4"></i> Academy</span>
                <span class="tag">Hover cards → preview</span>
              </div>
              <div class="showcase-count"><span data-gcur>1</span>/<span data-gtotal>1</span></div>
            </div>

            <div class="frame">
              <div class="frame-bar">
                <div class="dots3" aria-hidden="true"><span></span><span></span><span></span></div>
                <div class="text-xs muted">Course view</div>
                <div class="text-xs muted">fusionticks</div>
              </div>
              <div class="frame-media">
                <img data-gimg src="" alt="FT Academy screenshot" loading="lazy" decoding="async"/>
              </div>

              <button class="nav-arrow left" type="button" data-gprev aria-label="Previous image">
                <i data-lucide="chevron-left" class="w-5 h-5"></i>
              </button>
              <button class="nav-arrow right" type="button" data-gnext aria-label="Next image">
                <i data-lucide="chevron-right" class="w-5 h-5"></i>
              </button>
            </div>

            <div class="thumbs no-scrollbar" data-gthumbs aria-label="Thumbnails"></div>
          </div>
        </div>
      </div>

      <div class="mt-10 beam"></div>
    </section>

    <!-- FT JOURNAL -->
    <section id="journal" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow"><i data-lucide="notebook-pen" class="w-4 h-4"></i> Notion Journal</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">FT Journal</h3>
        <p class="mt-2 muted max-w-3xl">Track your trades, mistakes, and progress. Included with the course, or get it alone for $20.</p>
      </div>

      <div class="mt-8 grid lg:grid-cols-3 gap-6">
        <!-- LEFT -->
        <div class="lg:col-span-1 space-y-4">
          <article class="card reveal link-card" data-go="journal:0" tabindex="0">
            <div class="flex items-center gap-2 font-semibold"><i data-lucide="check-square" class="w-5 h-5 text-[var(--strap2)]"></i> Daily Trade Log</div>
            <p class="muted mt-2 text-sm">Entry, exit, setup, risk, and notes. Fast and clean.</p>
          </article>

          <article class="card reveal link-card" data-go="journal:1" tabindex="0">
            <div class="flex items-center gap-2 font-semibold"><i data-lucide="repeat" class="w-5 h-5 text-[var(--strap2)]"></i> Weekly Review</div>
            <p class="muted mt-2 text-sm">Spot patterns. Fix one mistake at a time.</p>
          </article>

          <article class="card reveal link-card" data-go="journal:2" tabindex="0">
            <div class="flex items-center gap-2 font-semibold"><i data-lucide="bar-chart-3" class="w-5 h-5 text-[var(--strap2)]"></i> Simple Stats</div>
            <p class="muted mt-2 text-sm">Win rate, R-multiples, best setups, and common errors.</p>
          </article>

          <div class="reveal flex flex-wrap gap-2">
            <a href="#pricing" class="btn btn-primary w-full justify-center"><i data-lucide="arrow-right" class="w-4 h-4"></i> Get Journal</a>
            <span class="tag">Included with Course</span>
            <span class="tag">$20 Standalone</span>
          </div>
        </div>

        <!-- RIGHT (SHOWCASE) -->
        <div class="lg:col-span-2">
          <div class="showcase reveal" data-gallery="journal" aria-label="Journal screenshots slider" tabindex="0">
            <div class="showcase-top">
              <div class="mini">
                <span class="tag"><i data-lucide="notebook-pen" class="w-4 h-4"></i> Journal</span>
                <span class="tag">Clean workflow</span>
              </div>
              <div class="showcase-count"><span data-gcur>1</span>/<span data-gtotal>1</span></div>
            </div>

            <div class="frame">
              <div class="frame-bar">
                <div class="dots3" aria-hidden="true"><span></span><span></span><span></span></div>
                <div class="text-xs muted">Notion template</div>
                <div class="text-xs muted">trading journal</div>
              </div>
              <div class="frame-media">
                <img data-gimg src="" alt="FT Journal screenshot" loading="lazy" decoding="async"/>
              </div>

              <button class="nav-arrow left" type="button" data-gprev aria-label="Previous image">
                <i data-lucide="chevron-left" class="w-5 h-5"></i>
              </button>
              <button class="nav-arrow right" type="button" data-gnext aria-label="Next image">
                <i data-lucide="chevron-right" class="w-5 h-5"></i>
              </button>
            </div>

            <div class="thumbs no-scrollbar" data-gthumbs aria-label="Thumbnails"></div>
          </div>
        </div>
      </div>

      <div class="mt-10 beam"></div>
    </section>

    <!-- DISCORD -->
    <section id="discord" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow"><i data-lucide="users" class="w-4 h-4"></i> Community</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">Discord Community</h3>
        <p class="mt-2 muted max-w-2xl">
          Chat, weekly news, and daily levels. Simple and useful.
        </p>
      </div>

      <div class="mt-8 grid lg:grid-cols-3 gap-6">
        <div class="lg:col-span-1 space-y-4">
          <article class="card reveal link-card" data-go="discord:0" tabindex="0">
            <div class="flex items-center gap-2 font-semibold">
              <span class="p-2 rounded-lg border border-[var(--edge)] bg-white"><i data-lucide="messages-square" class="w-5 h-5"></i></span>
              #chatroom
            </div>
            <p class="muted mt-3">Daily hangout. Share charts, ideas, and quick help.</p>
          </article>

          <article class="card reveal link-card" data-go="discord:1" tabindex="0">
            <div class="flex items-center gap-2 font-semibold">
              <span class="p-2 rounded-lg border border-[var(--edge)] bg-white"><i data-lucide="newspaper" class="w-5 h-5"></i></span>
              #market-news
            </div>
            <p class="muted mt-3">Weekly calendar: lean-in vs stay-light days.</p>
          </article>

          <article class="card reveal link-card" data-go="discord:2" tabindex="0">
            <div class="flex items-center gap-2 font-semibold">
              <span class="p-2 rounded-lg border border-[var(--edge)] bg-white"><i data-lucide="target" class="w-5 h-5"></i></span>
              #market-levels
            </div>
            <p class="muted mt-3">Daily levels: prepare, then confirm.</p>
            <div class="mt-4 flex flex-wrap gap-2 text-sm"><span class="tag">NQ</span><span class="tag">ES</span><span class="tag">CL</span><span class="tag">GC</span></div>
          </article>

          <a href="https://discord.gg/RFbe3nHB" target="_blank" class="btn btn-primary reveal w-full justify-center">
            <img src="./discord%20logo.png" class="w-4 h-4" alt=""> Join the Discord
          </a>
        </div>

        <div class="lg:col-span-2">
          <div class="showcase reveal" data-gallery="discord" aria-label="Discord screenshots slider" tabindex="0">
            <div class="showcase-top">
              <div class="mini">
                <span class="tag"><i data-lucide="users" class="w-4 h-4"></i> Discord</span>
                <span class="tag">Community</span>
              </div>
              <div class="showcase-count"><span data-gcur>1</span>/<span data-gtotal>1</span></div>
            </div>

            <div class="frame">
              <div class="frame-bar">
                <div class="dots3" aria-hidden="true"><span></span><span></span><span></span></div>
                <div class="text-xs muted">Server view</div>
                <div class="text-xs muted">fusionticks</div>
              </div>
              <div class="frame-media">
                <img data-gimg src="" alt="Discord screenshot" loading="lazy" decoding="async"/>
              </div>

              <button class="nav-arrow left" type="button" data-gprev aria-label="Previous image">
                <i data-lucide="chevron-left" class="w-5 h-5"></i>
              </button>
              <button class="nav-arrow right" type="button" data-gnext aria-label="Next image">
                <i data-lucide="chevron-right" class="w-5 h-5"></i>
              </button>
            </div>

            <div class="thumbs no-scrollbar" data-gthumbs aria-label="Thumbnails"></div>
          </div>
        </div>
      </div>

      <div class="mt-10 beam"></div>
    </section>

    <!-- PRICES -->
    <section id="pricing" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow">Choose Your Access</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">Prices</h3>
        <p class="mt-2 muted">First <b>40</b> get the full course for <b>$550</b> (regular <span class="line-through">$1000</span>). Lifetime updates included.</p>
      </div>

      <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
        <article class="card reveal">
          <div class="price">
            <div>
              <div class="font-semibold">FT Academy · Lifetime</div>
              <div class="mt-2 tag">First 40 only</div>
            </div>
            <div class="text-right">
              <div class="ring"><span class="text-2xl">$550</span></div>
              <div class="text-sm muted mt-1 line-through">$1000</div>
            </div>
          </div>
          <p class="muted mt-2">One-time payment. Includes all lessons now and all future updates.</p>
          <ul class="mt-3 space-y-2">
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Full course (current lessons)</li>
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Lifetime updates (future lessons)</li>
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Private Discord access (no live/levels/news)</li>
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Weekly live Q&amp;A & group study</li>
          </ul>
          <div class="pt-4">
            <a href="https://whop.com/checkout/plan_G0DWAmriWrJKp?d2c=true" class="btn btn-primary w-full justify-center">Get Course - $550</a>
            <p class="text-xs muted mt-2">Use code <b>FIRST40</b></p>
          </div>
        </article>

        <article class="card reveal">
          <div class="price">
            <div class="font-semibold">Live &amp; Levels · Subscription</div>
            <div class="text-2xl font-extrabold">$20<span class="text-sm muted">/mo</span></div>
          </div>
          <p class="muted mt-2">Everything you need day-to-day to stay prepared.</p>
          <ul class="mt-3 space-y-2">
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Daily pre-market live (plan + levels)</li>
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Today’s outlook & scenarios</li>
            <li class="flex gap-2"><i data-lucide="check" class="w-5 h-5 text-[var(--strap2)]"></i> Weekly news calendar</li>
          </ul>
          <div class="pt-4">
            <a href="https://YOUR_WHOP_LINK_SUB_20" class="btn btn-primary w-full justify-center">Subscribe - $20/mo</a>
          </div>
        </article>

        <article class="card reveal">
          <div class="price">
            <div class="font-semibold">ICT Concepts · Deep Dive</div>
            <div class="text-2xl font-extrabold">$1000</div>
          </div>
          <div class="mt-2 flex items-center gap-2 text-sm muted">
            <span class="relative flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full" style="background:var(--strap);opacity:.65"></span>
              <span class="relative inline-flex rounded-full h-2 w-2" style="background:var(--strap)"></span>
            </span>
            In progress: coming soon
          </div>
          <p class="muted mt-2">Full ICT framework: structure, execution models, case studies.</p>
          <ul class="mt-3 space-y-2">
            <li class="flex gap-2"><i data-lucide="dot" class="w-5 h-5 text-[var(--muted)]"></i> Comprehensive ICT framework</li>
            <li class="flex gap-2"><i data-lucide="dot" class="w-5 h-5 text-[var(--muted)]"></i> Clear setups & management rules</li>
            <li class="flex gap-2"><i data-lucide="dot" class="w-5 h-5 text-[var(--muted)]"></i> Real chart walk-throughs</li>
          </ul>
          <div class="pt-4">
            <button disabled class="btn w-full" style="opacity:.6; cursor:not-allowed">Coming Soon</button>
          </div>
        </article>
      </div>

      <div class="mt-10 beam"></div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
      <div class="reveal">
        <span class="eyebrow">FAQ</span>
        <h3 class="mt-3 font-display text-3xl sm:text-4xl font-extrabold">Still curious?</h3>
      </div>

      <div class="mt-6 space-y-4">
        <details class="card reveal">
          <summary class="cursor-pointer font-medium">Is this for beginners or advanced traders?</summary>
          <p class="muted mt-2">Both. We start with reading the market and build toward execution. Goal: create your own setups, not copy signals.</p>
        </details>
        <details class="card reveal">
          <summary class="cursor-pointer font-medium">What markets do you cover?</summary>
          <p class="muted mt-2">Focus on NQ, ES, CL, GC, plus context tracking through QQQ and SPY.</p>
        </details>
        <details class="card reveal">
          <summary class="cursor-pointer font-medium">Is the journal included?</summary>
          <p class="muted mt-2">Yes. The journal is included with the course, and it can also be purchased standalone.</p>
        </details>
        <details class="card reveal">
          <summary class="cursor-pointer font-medium">What language is the content?</summary>
          <p class="muted mt-2">Arabic.</p>
        </details>
      </div>

      <footer class="mt-14 py-10 border-t" style="border-color:var(--edge)">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-6 text-sm text-[var(--muted)] px-4">
          <div class="flex items-center gap-3">
            <img src="./FT%20Logo.png" alt="FusionTicks" class="h-7 w-auto">
            <span>© <span id="year"></span> FUSIONTICKS. All rights reserved.</span>
          </div>
          <div class="flex items-center gap-3">
            <a class="p-2 rounded-full border border-[var(--edge)] bg-white" href="https://www.instagram.com/fusionticks?igsh=dGZsOGJ4NnB3aHZo" target="_blank" aria-label="Instagram">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.6">
                <rect x="3" y="3" width="18" height="18" rx="5"></rect>
                <circle cx="12" cy="12" r="4"></circle>
                <circle cx="17.5" cy="6.5" r="1"></circle>
              </svg>
            </a>
            <a class="p-2 rounded-full border border-[var(--edge)] bg-white" href="https://youtube.com/@fusionticks?si=VMRgtVaI1V6DPgTb" target="_blank" aria-label="YouTube">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                <path d="M23 7.1a4 4 0 0 0-2.8-2.8C18.2 3.6 12 3.6 12 3.6s-6.2 0-8.2 .7A4 4 0 0 0 1 7.1C.4 9.1.4 12 .4 12s0 2.9.6 4.9a4 4 0 0 0 2.8 2.8c2 .6 8.2 .6 8.2 .6s6.2 0 8.2-.6a4 4 0 0 0 2.8-2.8c .6-2 .6-4.9 .6-4.9s0-2.9-.6-4.9zM9.8 15.6V8.4L16 12l-6.2 3.6z"/>
              </svg>
            </a>
            <a class="p-2 rounded-full border border-[var(--edge)] bg-white" href="https://www.tiktok.com/@fusionticks?_t=ZS-8zYOXn2fmDg&_r=1" target="_blank" aria-label="TikTok">
              <svg viewBox="0 0 48 48" width="18" height="18" fill="currentColor">
                <path d="M34.5 14.5a10.6 10.6 0 0 0 6.8 2.4v6a16.3 16.3 0 0 1-6.8-1.6v9.6a11.9 11.9 0 1 1-11-11.9v6a6 6 0 1 0 5 5.9V6h6v8.5z"/>
              </svg>
            </a>
          </div>
        </div>
      </footer>
    </section>
  </main>

  <!-- Sticky Checkout dock -->
  <div class="dock">
    <div class="dock-inner">
      <span class="hidden sm:inline text-sm">Use <b>FIRST40</b> for launch pricing</span>
      <a href="#pricing" class="btn btn-primary"><i data-lucide="arrow-right" class="w-4 h-4"></i> Get Access</a>
    </div>
  </div>

  <!-- ===== Course Syllabus Modal ===== -->
  <div id="currModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40" data-curr-close></div>
    <div class="relative max-w-4xl mx-auto mt-16 mb-10 rounded-2xl bg-white border border-[var(--edge)]">
      <div class="flex items-center justify-between px-5 py-4 border-b border-[var(--edge)]">
        <h3 class="text-lg font-semibold">Course · Full Syllabus</h3>
        <button class="btn-ghost btn" data-curr-close aria-label="Close"><i data-lucide="x"></i></button>
      </div>
      <div class="p-5 max-h-[70vh] overflow-y-auto no-scrollbar text-sm leading-relaxed">
        <div class="grid sm:grid-cols-2 gap-6">
          <article class="card">
            <h4 class="font-semibold text-base flex items-center gap-2">
              <i data-lucide="scan" class="w-4 h-4"></i> A · Reading the Market
            </h4>
            <ol class="mt-2 list-decimal pl-5 space-y-1">
              <li>Who’s in Control? (Candlesticks)</li>
              <li>Market Stages (Phases)</li>
              <li>Price in Motion</li>
              <li>Swings &amp; Shifts</li>
              <li>Breaks &amp; Flips (BOS &amp; CHoCH)</li>
              <li>Balance &amp; Imbalance (FVG)</li>
            </ol>
          </article>

          <article class="card">
            <h4 class="font-semibold text-base flex items-center gap-2">
              <i data-lucide="layout" class="w-4 h-4"></i> B · Market Levels
            </h4>
            <ol class="mt-2 list-decimal pl-5 space-y-1" start="7">
              <li>Where it Starts (Supply &amp; Demand)</li>
              <li>Key Zones (Support &amp; Resistance)</li>
              <li>The Explosion (Opening Range Breakout)</li>
            </ol>
            <p class="mt-3 text-xs muted">Levels are not entries, wait for confirmations.</p>
          </article>

          <article class="card">
            <h4 class="font-semibold text-base flex items-center gap-2">
              <i data-lucide="activity" class="w-4 h-4"></i> C · Market Indicators
            </h4>
            <ol class="mt-2 list-decimal pl-5 space-y-1" start="10">
              <li>Volume Map (Volume Profile)</li>
              <li>VWAP &amp; Anchored</li>
              <li>EMA</li>
            </ol>
          </article>

          <article class="card">
            <h4 class="font-semibold text-base flex items-center gap-2">
              <i data-lucide="settings" class="w-4 h-4"></i> D · Behind the Scenes
            </h4>
            <ol class="mt-2 list-decimal pl-5 space-y-1" start="13">
              <li>Quick Guide to TradingView</li>
              <li>Futures &amp; Prop Firms</li>
              <li>Order Types</li>
              <li>Risk First (Risk Management)</li>
              <li>Journaling &amp; Reviews</li>
              <li>News &amp; Economic Events</li>
              <li>Psychology</li>
            </ol>
          </article>
        </div>
      </div>
    </div>
  </div>

  <script>
    // icons + year
    document.addEventListener('DOMContentLoaded', ()=>{ if(window.lucide) lucide.createIcons(); });
    document.getElementById('year').textContent = new Date().getFullYear();

    // reveal
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); }});
    },{threshold:.14});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // mobile menu
    const menuBtn = document.getElementById('menuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const closeAll = ()=> mobileMenu.classList.add('hidden');
    menuBtn?.addEventListener('click', ()=> mobileMenu.classList.remove('hidden'));
    mobileMenu?.querySelectorAll('[data-close]').forEach(b=> b.addEventListener('click', closeAll));
    mobileMenu?.querySelectorAll('a[href^="#"]').forEach(a=> a.addEventListener('click', ()=> setTimeout(closeAll, 50)));

    // syllabus modal
    const hookModal = (openSel, modalId, closeSel) => {
      const modal = document.getElementById(modalId);
      document.querySelectorAll(openSel).forEach(btn=>btn.addEventListener('click', ()=>{
        modal.classList.remove('hidden');
        document.body.classList.add('modal-open');
      }));
      modal.querySelectorAll(closeSel).forEach(btn=>btn.addEventListener('click', ()=>{
        modal.classList.add('hidden');
        document.body.classList.remove('modal-open');
      }));
      modal.addEventListener('click', (e)=>{
        if(e.target === modal.firstElementChild) {
          modal.classList.add('hidden');
          document.body.classList.remove('modal-open');
        }
      });
    };
    hookModal('[data-curr-open]','currModal','[data-curr-close]');

    // sparkline
    (function(){
      const c = document.getElementById('spark'); if(!c) return;
      const ctx = c.getContext('2d');
      let DPR = Math.min(2, devicePixelRatio||1);
      const resize = ()=>{
        const r = c.getBoundingClientRect();
        c.width = Math.floor(r.width*DPR);
        c.height = Math.floor(r.height*DPR);
      };
      const ro = new ResizeObserver(resize); ro.observe(c.parentElement); resize();

      const W = ()=> c.width, H = ()=> c.height;
      let t = 0;
      const dots = Array.from({length:42}, ()=>({o:Math.random()}));

      function grid(){
        ctx.save();
        ctx.globalAlpha = .18;
        ctx.strokeStyle = "#CBD8EE";
        ctx.lineWidth = 1*DPR;
        const s = 36*DPR;
        for(let x=0;x<W();x+=s){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H()); ctx.stroke(); }
        for(let y=0;y<H();y+=s){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(W(),y); ctx.stroke(); }
        ctx.restore();
      }
      function lineGrad(){
        const g = ctx.createLinearGradient(0,0,W(),0);
        g.addColorStop(0, "#2563EB");
        g.addColorStop(1, "#0EA5E9");
        return g;
      }
      function curve(x){
        return H()*0.55 + (Math.sin(x*0.010 + t)*0.9 + Math.sin(x*0.0035 - t*1.15)*0.65)*H()*0.18;
      }
      function draw(){
        t += .012;
        ctx.clearRect(0,0,W(),H());
        grid();

        ctx.beginPath();
        for(let x=0;x<W();x++){ const y=curve(x); x===0?ctx.moveTo(x,y):ctx.lineTo(x,y); }
        ctx.lineTo(W(),H()); ctx.lineTo(0,H()); ctx.closePath();
        const ag = ctx.createLinearGradient(0,0,0,H());
        ag.addColorStop(0,"rgba(37,99,235,.14)");
        ag.addColorStop(1,"rgba(14,165,233,.04)");
        ctx.fillStyle = ag; ctx.fill();

        ctx.lineWidth = 2*DPR; ctx.strokeStyle = lineGrad();
        ctx.beginPath();
        for(let x=0;x<W();x++){ const y=curve(x); x===0?ctx.moveTo(x,y):ctx.lineTo(x,y); }
        ctx.stroke();

        ctx.save();
        ctx.shadowColor = "rgba(14,165,233,.6)"; ctx.shadowBlur = 18*DPR;
        ctx.stroke();
        ctx.restore();

        ctx.fillStyle = "#0EA5E9";
        dots.forEach((d,i)=>{
          const x = (((i/dots.length) + (t*0.03)) % 1) * W();
          const y = curve(x);
          ctx.beginPath(); ctx.arc(x,y,1.6*DPR,0,Math.PI*2); ctx.fill();
        });

        requestAnimationFrame(draw);
      }
      draw();
    })();

    /* =================== ONLY FOR 3 SECTIONS (ACADEMY / JOURNAL / DISCORD) =================== */
    (function(){
      const specs = {
        academy: { max: 6, prefix: './academy-', ext: 'webp', startIndex: 0 },
        journal: { max: 6, prefix: './journal-', ext: 'webp', startIndex: 0 },
        discord: { max: 5, prefix: './discord-', ext: 'webp', startIndex: 0 },
      };

      function loadable(url, timeoutMs=2200){
        return new Promise((resolve)=>{
          const img = new Image();
          let done = false;
          const t = setTimeout(()=>{ if(!done){ done=true; resolve(false); } }, timeoutMs);
          img.onload = ()=>{ if(done) return; done=true; clearTimeout(t); resolve(true); };
          img.onerror = ()=>{ if(done) return; done=true; clearTimeout(t); resolve(false); };
          img.src = url;
        });
      }

      async function buildUrls(spec){
        const urls = [];
        for(let i=1;i<=spec.max;i++){
          const u = `${spec.prefix}${i}.${spec.ext}`;
          // keep order, only push if file exists
          if(await loadable(u)) urls.push(u);
        }
        return urls;
      }

      function createGallery(root, urls){
        const imgEl = root.querySelector('[data-gimg]');
        const prevBtn = root.querySelector('[data-gprev]');
        const nextBtn = root.querySelector('[data-gnext]');
        const thumbsWrap = root.querySelector('[data-gthumbs]');
        const curEl = root.querySelector('[data-gcur]');
        const totalEl = root.querySelector('[data-gtotal]');

        let idx = 0;
        let busy = false;
        let timer = null;

        const thumbs = [];

        function setActiveCardForGallery(name, index){
          document.querySelectorAll(`[data-go^="${name}:"]`).forEach(el=>{
            const n = Number(String(el.getAttribute('data-go')).split(':')[1] || -1);
            el.classList.toggle('is-active', n === index);
          });
        }

        function paintThumbs(){
          thumbsWrap.innerHTML = '';
          urls.forEach((u, i)=>{
            const t = document.createElement('button');
            t.type = 'button';
            t.className = 'thumb';
            t.setAttribute('aria-label', `Open image ${i+1}`);
            const im = document.createElement('img');
            im.loading = 'lazy';
            im.decoding = 'async';
            im.src = u;
            im.alt = 'thumbnail';
            t.appendChild(im);
            t.addEventListener('click', ()=> go(i, true));
            thumbsWrap.appendChild(t);
            thumbs.push(t);
          });
        }

        function updateUI(){
          if(curEl) curEl.textContent = String(idx + 1);
          if(totalEl) totalEl.textContent = String(urls.length);
          thumbs.forEach((t, i)=> t.classList.toggle('is-active', i === idx));
          root.style.setProperty('--stage-bg', `url("${urls[idx]}")`);
        }

        function go(newIndex, fromUser=false){
          if(!urls.length || busy) return;
          busy = true;

          idx = (newIndex + urls.length) % urls.length;

          const nextSrc = urls[idx];
          const temp = new Image();
          temp.onload = ()=>{
            imgEl.classList.remove('is-visible');
            // small delay for nicer fade
            setTimeout(()=>{
              imgEl.src = nextSrc;
              imgEl.classList.add('is-visible');
              updateUI();
              busy = false;
            }, 110);
          };
          temp.onerror = ()=>{ busy = false; };
          temp.src = nextSrc;

          // pause autoplay قليلاً إذا المستخدم تفاعل
          if(fromUser) restartAutoplay(6500);
        }

        function next(){ go(idx+1, true); }
        function prev(){ go(idx-1, true); }

        function restartAutoplay(delay=5200){
          if(timer) clearInterval(timer);
          timer = setInterval(()=> go(idx+1, false), delay);
        }

        // init
        paintThumbs();
        imgEl.src = urls[0];
        imgEl.classList.add('is-visible');
        updateUI();
        restartAutoplay(5200);

        prevBtn?.addEventListener('click', prev);
        nextBtn?.addEventListener('click', next);

        // pause on hover/focus
        const stop = ()=>{ if(timer) clearInterval(timer); timer=null; };
        const resume = ()=> restartAutoplay(5200);
        root.addEventListener('mouseenter', stop);
        root.addEventListener('mouseleave', resume);
        root.addEventListener('focusin', stop);
        root.addEventListener('focusout', resume);

        // keyboard
        root.addEventListener('keydown', (e)=>{
          if(e.key === 'ArrowLeft') prev();
          if(e.key === 'ArrowRight') next();
        });

        // touch swipe
        let sx=0, sy=0, start=false;
        root.addEventListener('touchstart', (e)=>{
          const t = e.touches?.[0]; if(!t) return;
          start=true; sx=t.clientX; sy=t.clientY;
        }, {passive:true});
        root.addEventListener('touchend', (e)=>{
          if(!start) return; start=false;
          const t = e.changedTouches?.[0]; if(!t) return;
          const dx = t.clientX - sx;
          const dy = t.clientY - sy;
          if(Math.abs(dx) > 40 && Math.abs(dy) < 60){
            dx > 0 ? prev() : next();
          }
        }, {passive:true});

        // return API
        return {
          setIndex(i){
            go(i, true);
          },
          setActiveCard(index){
            setActiveCardForGallery(root.getAttribute('data-gallery'), index);
          }
        };
      }

      (async function initAll(){
        const roots = Array.from(document.querySelectorAll('[data-gallery]'));
        const api = {};

        for(const r of roots){
          const name = r.getAttribute('data-gallery');
          const spec = specs[name];
          if(!spec) continue;

          const urls = await buildUrls(spec);
          if(!urls.length){
            // fallback if no images found
            const imgEl = r.querySelector('[data-gimg]');
            if(imgEl){
              imgEl.alt = 'No images found';
              imgEl.removeAttribute('src');
            }
            continue;
          }
          api[name] = createGallery(r, urls);
        }

        // connect left cards (hover/focus) to galleries
        document.querySelectorAll('[data-go]').forEach(el=>{
          const raw = String(el.getAttribute('data-go') || '');
          const [name, nStr] = raw.split(':');
          const n = Number(nStr);
          if(!api[name] || Number.isNaN(n)) return;

          const fire = ()=>{
            api[name].setIndex(n);
            // highlight active card
            document.querySelectorAll(`[data-go^="${name}:"]`).forEach(x=>x.classList.remove('is-active'));
            el.classList.add('is-active');
          };

          el.addEventListener('mouseenter', fire);
          el.addEventListener('focus', fire);
          el.addEventListener('click', fire);
        });
      })();
    })();
  </script>
</body>
</html>
